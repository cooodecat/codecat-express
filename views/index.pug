extends layout

block content
    // Page-specific styles injected for this page only
    style.
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #f0f0f0, #e5e5e5);
            min-height: 100vh;
            overflow-x: auto;
        }
        .play-section {
            text-align: center;
            margin: 40px 0;
        }
        .play-btn {
            background: linear-gradient(45deg, #2e7d32, #66bb6a);
            border: 3px solid #1b5e20;
            border-radius: 25px;
            padding: 15px 60px;
            font-size: 32px;
            font-weight: bold;
            color: #f0fff4;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            box-shadow: 0 8px 20px rgba(27, 94, 32, 0.35);
            cursor: pointer;
            transition: all 0.3s;
        }
        .play-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(27, 94, 32, 0.45);
        }
        .stages-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 30px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin-bottom: 50px;
        }
        .stage-card {
            background: linear-gradient(145deg, #ffffff, #f5f5f5);
            border: 3px solid #d0d0d0;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        .stage-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }
        .stage-header {
            background: linear-gradient(45deg, #e0e0e0, #f0f0f0);
            border: 2px solid #c0c0c0;
            border-radius: 15px;
            padding: 12px;
            text-align: center;
            margin-bottom: 15px;
            font-size: 20px;
            font-weight: bold;
            color: #333;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.5);
        }
        .stage-content {
            background: #f8f8f8;
            border: 2px solid #d0d0d0;
            border-radius: 12px;
            min-height: 200px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .stage-content:hover { background: #f0f0f0; }
        .stage-image {
            width: 100%;
            max-width: 150px;
            height: auto;
            border-radius: 8px;
            transition: transform 0.3s;
        }
        /* No-frame variant for full-bleed image card */
        .stage-content.no-frame { background: transparent; border: none; padding: 0; min-height: 0; }
        .stage-content.no-frame .stage-image { width: 100%; height: 200px; max-width: none; border-radius: 12px; display: block; object-fit: cover; }
        .stage-content:hover .stage-image { transform: scale(1.05); }
        /* Card-less variant: only image clickable */
        .stage-card.no-frame { background: transparent; border: none; padding: 0; box-shadow: none; }
        .stage-card.no-frame a { display: block; -webkit-tap-highlight-color: transparent; }
        .stage-card.no-frame .stage-cover {
            width: 100%;
            height: auto;
            aspect-ratio: 16 / 9;
            display: block;
            border-radius: 12px;
            object-fit: cover;
        }
        .stage-placeholder {
            width: 100%;
            height: 150px;
            background: linear-gradient(45deg, #e0e0e0, #f0f0f0);
            border: 2px dashed #c0c0c0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 14px;
            text-align: center;
        }
        .stage-icons { display: flex; justify-content: center; gap: 15px; margin: 20px 0; }
        .stage-icon {
            width: 50px; height: 50px; border-radius: 50%; border: 3px solid #d0d0d0;
            display: flex; align-items: center; justify-content: center; font-weight: bold; color: #333; font-size: 14px; background: #f0f0f0;
        }
        .stage-icon.active { background: linear-gradient(45deg, #D2691E, #FF8C00); border-color: #D2691E; color: white; }
        .stage-icon.completed { background: linear-gradient(45deg, #4CAF50, #45a049); border-color: #4CAF50; color: white; }
        .stage-icon.locked { background: #e0e0e0; border-color: #c0c0c0; color: #999; }
        .free-btn { background: linear-gradient(45deg, #D2691E, #FF8C00); border: 2px solid #c0c0c0; border-radius: 15px; padding: 8px 20px; color: white; font-weight: bold; cursor: pointer; transition: all 0.3s; align-self: flex-start; }
        .free-btn:hover { transform: scale(1.05); }
        .stage-description { color: #333; font-size: 14px; text-align: center; margin-top: 10px; font-weight: 500; }
        .stars { text-align: right; color: #ffd700; font-size: 20px; margin-top: 10px; }
        @media (max-width: 768px) {
            .stages-container { grid-template-columns: 1fr; gap: 16px; padding: 0 16px; }
            .play-section { margin: 24px 0; }
            .play-btn { font-size: 24px; padding: 12px 20px; width: 100%; max-width: 320px; }
            .stage-card.no-frame .stage-cover { aspect-ratio: 4 / 3; }
        }
        @media (prefers-reduced-motion: reduce) {
            .stage-content:hover .stage-image { transform: none; }
        }

    // Page content
    .play-section
        button.play-btn PLAY

    .stages-container
        each stageNum in [1,2,3,4,5,6]
            - var href, src, fallbackLabel;
            if stageNum === 1
                - href = 'https://github.com/KJ-31/witple';
                - src = '/images/witple.png';
                - fallbackLabel = 'witple';
            else if stageNum === 2
                - href = 'https://github.com/MW-1st';
                - src = '/images/stage2.png';
                - fallbackLabel = 'Stage 2';
            else if stageNum === 3
                - href = 'https://github.com/teamKimtaerin';
                - src = '/images/stage3.png';
                - fallbackLabel = 'Stage 3';
            else if stageNum === 4
                - href = 'https://github.com/cooodecat';
                - src = '/images/otto.png';
                - fallbackLabel = 'otto';
            else if stageNum === 5
                - href = 'https://github.com/Team-Ooleem';
                - src = '/images/stage5.png';
                - fallbackLabel = 'Stage 5';
            else if stageNum === 6
                - href = 'https://github.com/KJ-9th-NMM-Team2/wheretoput';
                - src = '/images/wheretoput.png';
                - fallbackLabel = 'wheretoput';
            else
                - href = 'https://example.com/stage' + stageNum;
                - src = '/images/stage' + stageNum + '.png';
                - fallbackLabel = 'Stage ' + stageNum;
            .stage-card.no-frame
                a(href=href, target='_blank', rel='noopener noreferrer')
                    img.stage-cover(src=src, alt=fallbackLabel, onerror=`this.onerror=null;this.src='data:image/svg+xml;utf8,<svg xmlns=\\'http://www.w3.org/2000/svg\\' width=\\'300\\' height=\\'200\\'><rect width=\\'100%\\' height=\\'100%\\' fill=\\'%230b3d2e\\'/><text x=\\'50%\\' y=\\'50%\\' dominant-baseline=\\'middle\\' text-anchor=\\'middle\\' fill=\\'white\\' font-size=\\'18\\'>${fallbackLabel}</text></svg>'`)

    script.
        function openLink(url) { window.open(url, '_blank'); }
        function addImageToStage(stageNumber, imageUrl) {
            const stageContent = document.querySelectorAll('.stage-content')[stageNumber - 1];
            const placeholder = stageContent.querySelector('.stage-placeholder');
            if (placeholder) {
                placeholder.innerHTML = `<img src="${imageUrl}" class="stage-image" alt="Stage ${stageNumber}">`;
            }
        }